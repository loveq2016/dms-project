<?xml version="1.0" encoding="UTF-8" ?>  
    <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Flow">

<resultMap type="Flow" id="FlowMap">
	<id property="flow_id" column="flow_id" />
	<id property="flow_name" column="flow_name" />
	<id property="flow_desc" column="flow_desc" />
	<id property="is_system" column="is_system" />
	<id property="del_sign" column="del_sign" />
	<id property="add_emp_id" column="add_emp_id" />
	<id property="add_date" column="add_date" />
	<id property="mody_emp_id" column="mody_emp_id" />
	<id property="mody_date" column="mody_date" />
	<id property="del_emp_id" column="del_emp_id" />
	<id property="del_date" column="del_date" />
	<id property="order_no" column="order_no" />
	<collection property="actions" column="step_id" ofType="Action" 
	javaType="ArrayList" resultMap="ActionMap"></collection>
</resultMap>

<resultMap type="Action" id="ActionMap">
	<id property="action_id" column="action_id" />
	<id property="action_name" column="action_name" />
	<id property="action_desc" column="action_desc" />
	<id property="del_sign" column="del_sign" />
	<id property="add_emp_id" column="add_emp_id" />
	<id property="add_date" column="add_date" />
	<id property="mody_emp_id" column="mody_emp_id" />
	<id property="mody_date" column="mody_date" />
	<id property="del_emp_id" column="del_emp_id" />
	<id property="del_date" column="del_date" />
	<id property="order_no" column="order_no" />
</resultMap>

  <select id="getRoles" resultMap="RoleMap" >

        select

            r.id as r_id , r.rolename, r.roledescription,

            m.id as m_id, modulename, moduledescription,

            rm.id as rm_id, rm.roleid, rm.moduleid

        from roles r

            left outer join role_module rm on r.id=rm.roleid

            left outer join modules m on m.id= rm.moduleid

     </select>

</mapper>